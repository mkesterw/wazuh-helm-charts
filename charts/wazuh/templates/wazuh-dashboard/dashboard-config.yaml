apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "wazuh.fullname" . }}-dashboard-config
  namespace: {{ .Values.global.namespace }}
  labels:
    {{- include "wazuh.labels" . | nindent 4 }}
data:
  opensearch_dashboards.yml: |
    server.host: "0.0.0.0"
    server.port: 5601
    {{- if eq .Values.wazuhDashboard.env.serverSslEnabled "false" }}
    server.ssl.enabled: false
    {{- else }}
    server.ssl.enabled: true
    server.ssl.certificate: /etc/wazuh-dashboard/certs/dashboard.pem
    server.ssl.key: /etc/wazuh-dashboard/certs/dashboard-key.pem
    {{- end }}
    
    opensearch.hosts: ["{{ .Values.wazuhDashboard.env.opensearchHosts }}"]
    opensearch.ssl.verificationMode: none
    opensearch.username: "${INDEXER_USERNAME}"
    opensearch.password: "${INDEXER_PASSWORD}"
    opensearch.requestHeadersWhitelist: ["securitytenant","Authorization"]
    
    opensearch_security.multitenancy.enabled: false
    opensearch_security.readonly_mode.roles: ["kibana_read_only"]
    
    server.defaultRoute: /app/wz-home