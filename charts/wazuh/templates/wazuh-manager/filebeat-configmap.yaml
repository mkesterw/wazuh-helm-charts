{{- if or .Values.wazuhManager.master.enabled .Values.wazuhManager.worker.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "wazuh.fullname" . }}-filebeat-config
  namespace: {{ .Values.global.namespace }}
  labels:
    {{- include "wazuh.labels" . | nindent 4 }}
    app: wazuh-manager
data:
  filebeat.yml: |
    # Configuração para Filebeat 7.10.2 bundled (desativado, apenas para evitar erros)
    # O Filebeat 8.x sidecar fará todo o trabalho de coleta e envio
    
    filebeat.inputs:
      - type: log
        enabled: true
        paths:
          - /tmp/filebeat-dummy-*.log
        close_inactive: 1s
        scan_frequency: 30s

    setup.template.enabled: false
    setup.ilm.enabled: false
    
    logging.level: error
    logging.to_files: false

    output.elasticsearch:
      hosts: ["http://wazuh-indexer:9200"]
      username: "admin"
      password: "admin"
{{- end }}
