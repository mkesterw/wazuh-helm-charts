# Valores padrão para o Wazuh Helm Chart

# Configurações globais
global:
  namespace: wazuh
  storageClass: ""
  imageRegistry: docker.io
  imagePullPolicy: IfNotPresent
  imagePullSecrets: []

# Configurações do Wazuh Manager
wazuhManager:
  master:
    enabled: true
    replicaCount: 1
    
    image:
      repository: wazuh/wazuh-manager
      tag: "4.9.1"  # ← MUDOU de 5.0.0 para 4.9.1
      pullPolicy: IfNotPresent
    
    resources:
      limits:
        cpu: 400m
        memory: 512Mi
      requests:
        cpu: 200m
        memory: 256Mi
    
    persistence:
      enabled: true
      size: 10Gi
      storageClass: ""
      accessModes:
        - ReadWriteOnce
    
    securityContext:
      fsGroup: 101
      capabilities:
        add: ["SYS_CHROOT"]
    
    nodeSelector: {}
    tolerations: []
    affinity: {}
  
  worker:
    enabled: true
    replicaCount: 2
    
    image:
      repository: wazuh/wazuh-manager
      tag: "4.9.1"  # ← MUDOU de 5.0.0 para 4.9.1
      pullPolicy: IfNotPresent
    
    resources:
      limits:
        cpu: 400m
        memory: 512Mi
      requests:
        cpu: 200m
        memory: 256Mi
    
    persistence:
      enabled: true
      size: 10Gi
      storageClass: ""
      accessModes:
        - ReadWriteOnce
    
    securityContext:
      fsGroup: 101
      capabilities:
        add: ["SYS_CHROOT"]
    
    antiAffinity: soft
    nodeSelector: {}
    tolerations: []
  
  service:
    api:
      type: ClusterIP
      port: 55000
      annotations: {}
    registration:
      type: ClusterIP
      port: 1515
      annotations: {}
    events:
      type: ClusterIP
      port: 1514
      annotations: {}
    cluster:
      type: ClusterIP
      port: 1516
      clusterIP: None

# Configurações do Wazuh Indexer
wazuhIndexer:
  enabled: true
  replicaCount: 3
  
  image:
    repository: wazuh/wazuh-indexer
    tag: "4.9.1"  # ← MUDOU de 5.0.0 para 4.9.1
    pullPolicy: IfNotPresent
  
  resources:
    limits:
      cpu: 500m
      memory: 1564Mi
    requests:
      cpu: 250m
      memory: 1Gi
  
  persistence:
    enabled: true
    size: 50Gi
    storageClass: ""
    accessModes:
      - ReadWriteOnce
  
  javaOpts: "-Xms1g -Xmx1g -Dlog4j2.formatMsgNoLookups=true"
  
  cluster:
    initialClusterManagerNodes: "wazuh-indexer-0"
    seedHosts: "wazuh-indexer-0.wazuh-indexer,wazuh-indexer-1.wazuh-indexer,wazuh-indexer-2.wazuh-indexer"
    maxLocalStorageNodes: 3
  
  securityContext:
    fsGroup: 1000
    privileged: true
  
  service:
    type: ClusterIP
    ports:
      rest: 9200
      nodes: 9300
    clusterIP: None
  
  nodeSelector: {}
  tolerations: []
  affinity: {}
  networkPolicy:
    enabled: false

# Configurações do Wazuh Dashboard
wazuhDashboard:
  enabled: true
  replicaCount: 1
  
  image:
    repository: wazuh/wazuh-dashboard
    tag: "4.9.1"  # ← MUDOU de 5.0.0 para 4.9.1
    pullPolicy: IfNotPresent
  
  resources:
    limits:
      cpu: 500m
      memory: 1Gi
    requests:
      cpu: 250m
      memory: 512Mi
  
  service:
    type: ClusterIP
    port: 443
    annotations: {}
  
  ingress:
    enabled: false
    className: nginx
    annotations: {}
    hosts:
      - host: wazuh.example.com
        paths:
          - path: /
            pathType: Prefix
    tls: []
  
  env:
    opensearchHosts: "https://wazuh-indexer:9200"
    serverSslEnabled: "true"
    wazuhApiUrl: "https://wazuh-api"
  
  nodeSelector: {}
  tolerations: []
  affinity: {}
  networkPolicy:
    enabled: false

# ... resto do arquivo permanece igual
# ... (todo o conteúdo anterior permanece)

# Configurações de Secrets
secrets:
  indexer:
    username: "admin"
    password: "SecurePassword123!"
  dashboard:
    username: "kibanaserver"
    password: "kibanaserver"
  wazuhApi:
    username: "wazuh-wui"
    password: "MyS3cr37P450r.*-"
  authdPass: "please_change_me"
  tls:
    autoGenerate: true
    existingSecret: ""
    caCert: ""
    serverCert: ""
    serverKey: ""
    dashboardCert: ""
    dashboardKey: ""

# Network Policies
networkPolicies:
  enabled: false

# RBAC configuration
rbac:
  create: true

# Service Account ← ADICIONE/CORRIJA ESTA SEÇÃO COMPLETA
serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# Pod Security Policy
podSecurityPolicy:
  enabled: false